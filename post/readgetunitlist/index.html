<!DOCTYPE html>
<html>
  <head>
    <title>付録：getUnitList()  &middot; Kujira, Civ4 Mod Blog</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="付録, 講座, ">


<meta property="og:title" content="付録：getUnitList()  &middot; Kujira, Civ4 Mod Blog ">
<meta property="og:site_name" content="Kujira, Civ4 Mod Blog"/>
<meta property="og:url" content="https://gforestshade.github.io/kujira/post/readgetunitlist/" />
<meta property="og:locale" content="ja-JP">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2017-11-16T00:00:00Z" />
<meta property="og:article:modified_time" content="2017-11-16T00:00:00Z" />

  
    
<meta property="og:article:tag" content="付録">
    
<meta property="og:article:tag" content="講座">
    
  

  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@" />
<meta name="twitter:title" content="付録：getUnitList()" />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="https://gforestshade.github.io/kujira/post/readgetunitlist/" />
<meta name="twitter:domain" content="https://gforestshade.github.io/kujira/">
  

<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "付録：getUnitList()",
    "author": {
      "@type": "Person",
      "name": "http://profiles.google.com/+?rel=author"
    },
    "datePublished": "2017-11-16",
    "description": "",
    "wordCount":  2041 
  }
</script>



<link rel="canonical" href="https://gforestshade.github.io/kujira/post/readgetunitlist/" />

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://gforestshade.github.io/touch-icon-144-precomposed.png">
<link href="https://gforestshade.github.io/favicon.ico" rel="icon">

<meta name="generator" content="Hugo 0.62.2" />

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous" />
<link href="https://stackpath.bootstrapcdn.com/bootswatch/4.1.0/materia/bootstrap.min.css" rel="stylesheet" integrity="sha384-BJWCnw/x/9+kQsLGLQDoCX2oJg7j1LjkOfPZWtUPTJ0tn00hYIB5r9u7KnGJxFnY" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow-night-eighties.min.css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

<link rel="stylesheet" href="https://gforestshade.github.io/kujira/css/style.css" />


    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-111798374-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    </head>

    <body id="index" class="archive">
      <nav class="navbar navbar-expand-md navbar-dark px-5 navbar-color">
        <a class="navbar-brand" href="https://gforestshade.github.io/kujira/">Kujira, Civ4 Mod Blog</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse"
                data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false"
                aria-label="Toggle navigation">
          &#9776;
        </button>
        <div class="mx-md-4"></div>
        <div class="collapse navbar-collapse" id="navbarNav">
          <div class="nav navbar-nav">
            
            
              <a class="nav-item nav-link menu-item mx-md-2" href="https://gforestshade.github.io/kujira/post/hajimeni/">
              <i class='fa fa-star'></i>
              <span>はじめに</span>
              </a>
            
              <a class="nav-item nav-link menu-item mx-md-2" href="https://gforestshade.github.io/kujira/page/license/">
              <i class='fa fa-file'></i>
              <span>LICENSE</span>
              </a>
            
          </div>
        </div>
      </nav>
      <div class="m-3"></div>

<div id="whole">
  <div class="leftbar">
    




<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a class="collapsed" data-toggle="collapse" href="#collist_0" role="button">目次</a></h5>
  </div>
  <div role="tabpanel" id="collist_0" class="collapse show">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/hajimeni/">はじめに</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a data-toggle="collapse" href="#collist_1" role="button">Python</a></h5>
  </div>
  <div role="tabpanel" id="collist_1" class="collapse">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted1/">はじめてのPythonMOD 1</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted2/">はじめてのPythonMOD 2</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted3/">はじめてのPythonMOD 3</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted4/">はじめてのPythonMOD 4</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted5/">はじめてのPythonMOD 5</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted6/">はじめてのPythonMOD 6</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted7/">はじめてのPythonMOD 7</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy1/">それからのPython 1</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy2/">それからのPython 2</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy3/">それからのPython 3</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy4/">それからのPython 4</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy5/">それからのPython 5</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy6/">それからのPython 6</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy7/">それからのPython 7</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy8/">それからのPython 8</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy9/">それからのPython 9</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy10/">それからのPython 10</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a data-toggle="collapse" href="#collist_2" role="button">XML</a></h5>
  </div>
  <div role="tabpanel" id="collist_2" class="collapse">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4unitinfos/">CIV4UnitInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4unitclassinfos/">CIV4UnitClassInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4buildinginfos/">CIV4BuildingInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/keyichiran/">XMLキー一覧_new</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4leaderheadinfos/">CIV4LeaderHeadInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4civilizationinfos/">Civ4CivilizationInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4civicinfos/">Civ4CivicInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/glossary/">用語集</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4techinfos/">Civ4TechInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4traitinfos/">Civ4TraitInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4buildingclassinfos/">CIV4BuildingClassInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4promotioninfos/">CIV4PromotionInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4projectinfos/">CIV4ProjectInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4handicapinfo/">CIV4HandicapInfo.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4bonusinfos/">CIV4BonusInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4improvementinfos/">CIV4ImprovementInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4gamespeedinfo/">CIV4GameSpeedInfo.xml</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a data-toggle="collapse" href="#collist_3" role="button">C&#43;&#43;</a></h5>
  </div>
  <div role="tabpanel" id="collist_3" class="collapse">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/howtocompile/">CvGameCoreDll.dllの作り方(2018-02)</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/howtocompiledoc/">CvGameCoreDll.dllの作り方(2018-05)</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a data-toggle="collapse" href="#collist_4" role="button">コラム</a></h5>
  </div>
  <div role="tabpanel" id="collist_4" class="collapse">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/power/">通常電力、きたない電力</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/movement/">移動力と地形コスト</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/irrigation/">灌漑</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a data-toggle="collapse" href="#collist_5" role="button">MMD_to_CIV4</a></h5>
  </div>
  <div role="tabpanel" id="collist_5" class="collapse">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/mmd_to_nif/">MMDモデルをCiv4に登場させたい</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/nifanimation/">MMDモデルをCiv4上で動かしたい</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



 







  </div>
  <div class="centerbar">
    <div class="container-fluid">
            <div class="card card-body my-3">
        <div class="article-title">
          

  
    
    
      
    
      
    
      
    
      
    
      
          <a href="https://gforestshade.github.io/kujira/post/readgetunitlist/" itemprop="url">
            <img src="https://gforestshade.github.io/kujira/banner/green1024x200.png" class="img-fluid border rounded" alt="Generic responsive image">
          </a>
          
      
    
  
  <div class="py-3" ></div>


          <h1 class="article-title">付録：getUnitList()</h1>
        </div>
        <div class="article-info text-muted d-flex flex-wrap align-items-center align-items-end flex-row justify-content-end mt-1 mb-3">
          <p><time datetime="2017-11-16">2017-11-16 00:00</time></p>
          
          <p>2041  Words</p>
          
          

          

          
          <p>
            タグ：
            
            <a class="btn btn-sm btn-outline-info" href="https://gforestshade.github.io/kujira/tags/%e4%bb%98%e9%8c%b2">付録</a>
            
            <a class="btn btn-sm btn-outline-info" href="https://gforestshade.github.io/kujira/tags/%e8%ac%9b%e5%ba%a7">講座</a>
            
          </p>
          
        </div>
        <div class="article">
          <h1 id="はじめに">はじめに</h1>
<ul>
<li><a href="https://gforestshade.github.io/kujira/post/secondpy6/">それからのPython その６</a>の付録</li>
<li>全ユニットを列挙するには</li>
</ul>
<h1 id="読む">読む</h1>
<p>早速</p>
<p><p class="path">
  C:\Program Files (x86)\CYBERFRONT\Sid Meier's Civilization 4(J)\Beyond the Sword(J)\Assets\Python\Pyhelpers.py
</p>
<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<p>を開いて、</p>
<p><code>getUnitList()</code>というメソッドを見ていきます&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">## Sid Meier&#39;s Civilization 4</span>
<span style="color:#75715e">## Copyright Firaxis Games 2005</span>
<span style="color:#f92672">from</span> CvPythonExtensions <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#75715e">#import Info as PyInfo</span>
<span style="color:#f92672">import</span> CvUtil
gc <span style="color:#f92672">=</span> CyGlobalContext()

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PyPlayer</span>:
	<span style="color:#75715e"># ...(中略)...</span>
	
	<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getUnitList</span>(self):
		<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> UnitList - All of the players alive units </span><span style="color:#e6db74">&#39;</span>
		lUnit <span style="color:#f92672">=</span> []
		(loopUnit, iter) <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>player<span style="color:#f92672">.</span>firstUnit(false)
		<span style="color:#66d9ef">while</span>( loopUnit ):
			<span style="color:#66d9ef">if</span> ( <span style="color:#f92672">not</span> loopUnit<span style="color:#f92672">.</span>isDead() ): <span style="color:#75715e">#is the unit alive and valid?</span>
				lUnit<span style="color:#f92672">.</span>append(loopUnit) <span style="color:#75715e">#add unit instance to list</span>
			(loopUnit, iter) <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>player<span style="color:#f92672">.</span>nextUnit(iter, false)
		<span style="color:#66d9ef">return</span> lUnit
</code></pre></div><p>最初に空のリストを作って、<code>lUnit = []</code><br>
最後にそのリストを返しています。<code>return lUnit</code><br>
その間に、変数<code>lUnit</code>に<code>CyUnit</code>のインスタンスを詰め込んでいきます。</p>
<p>まず<code>CyPlayer</code>のメソッド<code>firstUnit()</code>を呼び出しています。</p>
<pre><code>109. TUPLE firstUnit (BOOL bRev)
</code></pre>
<p>引数のBoolは「逆順に調べるか？」を表します。<br>
ここに<code>True</code>を指定すると逆順に調べることになりますが、<br>
ここでは<code>false</code>で順に調べています。</p>
<p>このメソッドが返すのは、「最初のユニットの<code>CyUnit</code>インスタンス」と「イテレータ」の<br>
２つが入った「タプル」です。</p>
<h2 id="タプル">タプル</h2>
<p>「タプル」はリストとすごく似ていますが、１点、<br>
タプルの中身は代入によっては変更できない、ということが異なります。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">listA <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">3</span>] <span style="color:#75715e"># リスト変数</span>
tupleB <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">3</span>) <span style="color:#75715e"># タプル変数</span>

listA[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#75715e"># 1番目を指定して書き換えができる</span>
<span style="color:#75715e"># tupleB[1] = 2 # タプルではできない、エラー</span>

<span style="color:#66d9ef">print</span> listA
<span style="color:#66d9ef">print</span> tupleB

ai, aj, ak <span style="color:#f92672">=</span> listA <span style="color:#75715e"># ばらして代入できる</span>
bi, bj, bk <span style="color:#f92672">=</span> tupleB <span style="color:#75715e"># タプルでもできる(タプルの中身を変更しているわけではないのでOK)</span>

<span style="color:#66d9ef">print</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">ai = </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">, aj = </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">, ak = </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (ai, aj, ak) <span style="color:#75715e"># フォーマット文字列の変数指定にタプルが利用できる</span>
<span style="color:#66d9ef">print</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">bi = </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">, bj = </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">, bk = </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (bi, bj, bk) <span style="color:#75715e"># (bi, bj, bk)は新しく作ったタプルでありもとのタプルとは別物であることに注意</span>
</code></pre></div><p><code>PyPlayer.getUnitList()</code>の定義に目を戻すと、<br>
<code>(loopUnit, iter) = self.player.firstUnit(false)</code>とばらして代入しています。<br>
これで<code>loopUnit</code>は最初のユニットのインスタンス、<br>
<code>iter</code>は「イテレータ」という謎の存在が入っていることになります。</p>
<h1 id="while文">while文</h1>
<p>while文は繰り返しの一種です。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">while</span> (<span style="color:#960050;background-color:#1e0010">条</span><span style="color:#960050;background-color:#1e0010">件</span><span style="color:#960050;background-color:#1e0010">式</span>):
    (<span style="color:#960050;background-color:#1e0010">ブ</span><span style="color:#960050;background-color:#1e0010">ロ</span><span style="color:#960050;background-color:#1e0010">ッ</span><span style="color:#960050;background-color:#1e0010">ク</span>)
</code></pre></div><p>で「条件式が真の間」ブロックを何度でも繰り返し実行します。<br>
当然そのままだといつまでも繰り返しが終わらないので(無限ループと呼びます)、<br>
ブロック中で条件式に使っている変数を変更する必要があります。</p>
<p>例えば:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
<span style="color:#66d9ef">while</span> a <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">a = </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> a
    a <span style="color:#f92672">=</span> a <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#75715e"># aを1減らす。これがあることでそのうち条件を満たさなくなる</span>
</code></pre></div><p><code>PyPlayer.getUnitList()</code>の定義では、<br>
<code>while( loopUnit ):</code>となっています。<br>
変数をそのまま突っ込むことで、<code>loopUnit</code>が</p>
<ul>
<li><code>False</code></li>
<li>数値の<code>0</code></li>
<li>空の文字列<code>&quot;&quot;</code></li>
<li>空のタプル<code>()</code>・空のリスト<code>[]</code>・空のディクショナリ<code>{}</code></li>
<li><code>None</code></li>
</ul>
<p>のどれかに該当するまでブロックを繰り返すことになります。<br>
条件式において「偽」以外はすべて「真」でしたから、<br>
これらのどれにも該当しない値を取る間は「真」になりますね。</p>
<p>whileブロックの中を見ていきます。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;&gt;</span>
		<span style="color:#66d9ef">while</span>( loopUnit ):
			<span style="color:#66d9ef">if</span> ( <span style="color:#f92672">not</span> loopUnit<span style="color:#f92672">.</span>isDead() ): <span style="color:#75715e">#is the unit alive and valid?</span>
				lUnit<span style="color:#f92672">.</span>append(loopUnit) <span style="color:#75715e">#add unit instance to list</span>
			(loopUnit, iter) <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>player<span style="color:#f92672">.</span>nextUnit(iter, false)
<span style="color:#f92672">&lt;&lt;</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#f92672">&lt;&lt;</span><span style="color:#f92672">&lt;&lt;</span>
</code></pre></div><p><code>if( not loopUnit.isDead() ):</code>とあります。<br>
<code>not</code>は<code>True</code>と<code>False</code>を逆にするのでした。<br>
「「<code>loopUnit</code>が致死ダメージを負っているなら」の逆ならば」なので、<br>
「<code>loopUnit</code>が致死ダメージを負っていないなら」になります。<br>
もしそうならば、<code>lUnit.append(loopUnit)</code>で<br>
インスタンス<code>loopUnit</code>をリスト<code>lUnit</code>に追加しています。</p>
<p>ここまで、<code>loopUnit</code>は最初のユニットのインスタンスでした。<br>
ここで、<code>loopUnit</code>が次のユニットのインスタンスになってくれたら、<br>
繰り返しによって『もう一度<code>loopUnit</code>の生死判定→生きてたら追加→次のユニットへ』<br>
をずーっと繰り返していけば生きているユニットを全員リストに追加することができそうです。<br>
その『次のユニットを取得する』をやっているのが、<br>
<code>(loopUnit, iter) = self.player.nextUnit(iter, false)</code><br>
です。やっていることはつまり「イテレータ」を渡して、(falseは逆順にしないという意味でした)<br>
「次のユニット」と「更新された新しいイテレータ」を受け取るということです。<br>
おおざっぱに、「イテレータ」というのは、<br>
「いま何番目くらいのユニットを数えていたか覚えておいてくれるもの」<br>
という認識でいいでしょう。<br>
次のユニットを取得すると同時にイテレータの持つ位置情報も更新することで<br>
次に呼び出したときにはさらにその次のユニットが取得できるのですね。</p>
<p>最終的に、<code>nextUnit()</code>はユニットを最後まで数え終わると<br>
次のユニットとして<code>None</code>を返します。<code>loopUnit</code>の中身が<code>None</code>になりますから、<br>
<code>while( loopUnit ):</code>を満たさなくなってループが終了します。</p>
<p><code>CyPlayer</code>のメソッドだけから全ユニットのリストを取得するのは<br>
このようにすこし難しいですが、処理をまとめて提供してくれる便利クラスも<br>
同時に提供されているので、ありがたく使わせてもらいましょう。</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>パッケージ版の場合。Steam版は<span class="path">
  C:Program Files (x86)\Steam\SteamApps\common\Sid Meier's Civilization IV Beyond the Sword\Beyond the Sword\Assets\Python\Pyhelpers.py
</span>
 <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

        </div>
        <div class="col-12">
  
</div>

      </div>

    </div>
  </div>

<footer id="contentinfo" class="footer">
  <address id="about" class="vcard body ml-2">
     <a href="https://gforestshade.github.io/kujira/">Kujira, Civ4 Mod Blog</a>  &copy; 2020 gforest_shade; licenced by <a href="https://creativecommons.org/licenses/by/4.0/deed.ja">CC-BY-4.0</a>
  </address>
</footer>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

</body>
</html>

