<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>付録：継承１  &middot; Kujira, Civ4 Mod Blog</title>
    


<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5V7SPDZ');</script>




    <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="付録, 講座, ">


<meta property="og:title" content="付録：継承１  &middot; Kujira, Civ4 Mod Blog ">
<meta property="og:site_name" content="Kujira, Civ4 Mod Blog"/>
<meta property="og:url" content="https://gforestshade.github.io/kujira/post/secondpy_ex2/" />
<meta property="og:locale" content="ja-JP">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2017-12-04T00:00:00Z" />
<meta property="og:article:modified_time" content="2017-12-04T00:00:00Z" />

  
    
<meta property="og:article:tag" content="付録">
    
<meta property="og:article:tag" content="講座">
    
  

  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@" />
<meta name="twitter:title" content="付録：継承１" />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="https://gforestshade.github.io/kujira/post/secondpy_ex2/" />
<meta name="twitter:domain" content="https://gforestshade.github.io/kujira/">
  

<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "付録：継承１",
    "author": {
      "@type": "Person",
      "name": "http://profiles.google.com/+?rel=author"
    },
    "datePublished": "2017-12-04",
    "description": "",
    "wordCount":  5500 
  }
</script>




<link rel="canonical" href="https://gforestshade.github.io/kujira/post/secondpy_ex2/" />

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://gforestshade.github.io/touch-icon-144-precomposed.png">
<link href="https://gforestshade.github.io/favicon.ico" rel="icon">

<meta name="generator" content="Hugo 0.101.0" />

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous" />
<link href="https://stackpath.bootstrapcdn.com/bootswatch/4.1.0/materia/bootstrap.min.css" rel="stylesheet" integrity="sha384-BJWCnw/x/9+kQsLGLQDoCX2oJg7j1LjkOfPZWtUPTJ0tn00hYIB5r9u7KnGJxFnY" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow-night-eighties.min.css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">

<link rel="stylesheet" href="https://gforestshade.github.io/kujira/css/style.css" />


    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    </head>

    <body id="index" class="archive">
      


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5V7SPDZ"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>




      <nav class="navbar navbar-expand-md navbar-dark px-5 navbar-color">
        <a class="navbar-brand" href="https://gforestshade.github.io/kujira/">Kujira, Civ4 Mod Blog</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse"
                data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false"
                aria-label="Toggle navigation">
          &#9776;
        </button>
        <div class="mx-md-4"></div>
        <div class="collapse navbar-collapse" id="navbarNav">
          <div class="nav navbar-nav">
            
            
              <a class="nav-item nav-link menu-item mx-md-2" href="https://gforestshade.github.io/kujira/post/hajimeni/">
              <i class='fa fa-star'></i>
              <span>はじめに</span>
              </a>
            
              <a class="nav-item nav-link menu-item mx-md-2" href="https://gforestshade.github.io/kujira/page/license/">
              <i class='fa fa-file'></i>
              <span>LICENSE</span>
              </a>
            
          </div>
        </div>
      </nav>
      <div class="m-3"></div>

<div id="whole">
  <div class="leftbar">
    




<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a class="collapsed" data-toggle="collapse" href="#collist_0" role="button">目次</a></h5>
  </div>
  <div role="tabpanel" id="collist_0" class="collapse show">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/hajimeni/">はじめに</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a data-toggle="collapse" href="#collist_1" role="button">Python</a></h5>
  </div>
  <div role="tabpanel" id="collist_1" class="collapse">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted1/">はじめてのPythonMOD 1</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted2/">はじめてのPythonMOD 2</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted3/">はじめてのPythonMOD 3</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted4/">はじめてのPythonMOD 4</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted5/">はじめてのPythonMOD 5</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted6/">はじめてのPythonMOD 6</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/getstarted7/">はじめてのPythonMOD 7</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy1/">それからのPython 1</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy2/">それからのPython 2</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy3/">それからのPython 3</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy4/">それからのPython 4</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy5/">それからのPython 5</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy6/">それからのPython 6</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy7/">それからのPython 7</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy8/">それからのPython 8</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy9/">それからのPython 9</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/secondpy10/">それからのPython 10</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a data-toggle="collapse" href="#collist_2" role="button">XML</a></h5>
  </div>
  <div role="tabpanel" id="collist_2" class="collapse">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4unitinfos/">CIV4UnitInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4unitclassinfos/">CIV4UnitClassInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4buildinginfos/">CIV4BuildingInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/keyichiran/">XMLキー一覧_new</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4leaderheadinfos/">CIV4LeaderHeadInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4civilizationinfos/">Civ4CivilizationInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4civicinfos/">Civ4CivicInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/glossary/">用語集</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4techinfos/">Civ4TechInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4traitinfos/">Civ4TraitInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4buildingclassinfos/">CIV4BuildingClassInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4promotioninfos/">CIV4PromotionInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4projectinfos/">CIV4ProjectInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4handicapinfo/">CIV4HandicapInfo.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4bonusinfos/">CIV4BonusInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4improvementinfos/">CIV4ImprovementInfos.xml</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/civ4gamespeedinfo/">CIV4GameSpeedInfo.xml</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a data-toggle="collapse" href="#collist_3" role="button">C&#43;&#43;</a></h5>
  </div>
  <div role="tabpanel" id="collist_3" class="collapse">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/howtocompile/">CvGameCoreDll.dllの作り方(2018-02)</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/howtocompiledoc/">CvGameCoreDll.dllの作り方(2018-05)</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a data-toggle="collapse" href="#collist_4" role="button">コラム</a></h5>
  </div>
  <div role="tabpanel" id="collist_4" class="collapse">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/power/">通常電力、きたない電力</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/movement/">移動力と地形コスト</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/irrigation/">灌漑</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



<div class="card m-3">
  <div class="card-header" role="tab">
    
    <h5 class="mb-0"><a data-toggle="collapse" href="#collist_5" role="button">MMD_to_CIV4</a></h5>
  </div>
  <div role="tabpanel" id="collist_5" class="collapse">
    <div class="list-group list-group-flush">
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/mmd_to_nif/">MMDモデルをCiv4に登場させたい</a>
      
      <a class="list-group-item list-group-item-action" href="https://gforestshade.github.io/kujira/post/nifanimation/">MMDモデルをCiv4上で動かしたい</a>
      
    </div>
    <div class="card-footer p-2"></div>
  </div>
</div>



 







  </div>
  <div class="centerbar">
    <div class="container-fluid">
            <div class="card card-body my-3">
        <div class="article-title">
          

  
    
    
      
    
      
    
      
    
      
    
      
          <a href="https://gforestshade.github.io/kujira/post/secondpy_ex2/" itemprop="url">
            <img src="https://gforestshade.github.io/kujira/banner/green1024x200.png" class="img-fluid border rounded" alt="Generic responsive image">
          </a>
          
      
    
  
  <div class="py-3" ></div>


          <h1 class="article-title">付録：継承１</h1>
        </div>
        <div class="article-info text-muted d-flex flex-wrap align-items-center align-items-end flex-row justify-content-end mt-1 mb-3">
          <p><time datetime="2017-12-04">2017-12-04 00:00</time></p>
          
          <p>5500  Words</p>
          
          

          

          
          <p>
            タグ：
            
            <a class="btn btn-sm btn-outline-info" href="https://gforestshade.github.io/kujira/tags/%e4%bb%98%e9%8c%b2">付録</a>
            
            <a class="btn btn-sm btn-outline-info" href="https://gforestshade.github.io/kujira/tags/%e8%ac%9b%e5%ba%a7">講座</a>
            
          </p>
          
        </div>
        <div class="article">
          <h1 id="はじめに">はじめに</h1>
<ul>
<li>継承について</li>
<li>今回は理論回です。この回に出てくるコードはすべてMODではなく<br>
ただのPythonプログラムになっていますので、<a href="https://paiza.io/ja">paiza.io</a>などでためしましょう。<br>
(Python2を選ぶことを忘れずに。)</li>
</ul>
<h1 id="クラスの継承">クラスの継承</h1>
<p>「継承」(inheritance)という仕組みを使って、<br>
既存のクラスを拡張したクラスを新しく作ることができます。</p>
<p>とても簡単なクラスから始めましょう&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">A</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">methodA</span>():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;This is methodA().&#34;</span>
</span></span></code></pre></div><p>&hellip;というクラスがあったとき、&quot;<code>A</code>をもとにした新しいクラス<code>B</code>&ldquo;を<br>
<code>class クラス名(もとにするクラス名):</code>のようにして作ることができます&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">A</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">methodA</span>():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;This is methodA().&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">B</span>(A):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">methodB</span>():
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;This is methodB().&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> A() <span style="color:#75715e"># Aのインスタンスa</span>
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span>methodA() <span style="color:#75715e"># Aのインスタンスメソッドを呼び出せる</span>
</span></span><span style="display:flex;"><span>print s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> B() <span style="color:#75715e"># Bのインスタンスb</span>
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> b<span style="color:#f92672">.</span>methodB() <span style="color:#75715e"># Bのインスタンスメソッドを呼び出せる</span>
</span></span><span style="display:flex;"><span>print s
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> b<span style="color:#f92672">.</span>methodA() <span style="color:#75715e"># Aのインスタンスメソッドも呼び出せる！</span>
</span></span><span style="display:flex;"><span>print s
</span></span></code></pre></div><p>「継承」において、もとになったクラスを「基底クラス」(super class)、<br>
基底クラスを受け継いで新しく作ったクラスを「派生クラス」(derived class)または「サブクラス」(subclass)と呼びます。</p>
<p>派生クラスは基底クラスに定義されているものをすべてそのまま受け継ぎます。<br>
上の例で、<code>B</code>のインスタンス<code>b</code>を使って<code>b.methodA()</code>を呼び出していますが、<br>
<code>B</code>は<code>A</code>のメソッドを受け継いでいるので、<code>methodA()</code>と<code>methodB()</code>が両方とも存在することになります。</p>
<h1 id="使ってみる">使ってみる</h1>
<p>実際に継承の機能を使ってみましょう。<br>
まずとにかくもとになる基底クラスが必要です。<br>
RPGのキャラをモチーフにしたクラスから始めてみましょう&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># -*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Unit</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;RPGのキャラっぽいなにか&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, hp, attack, defence):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;初期化時にHP,攻撃力,防御力を設定する&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>hp <span style="color:#f92672">=</span> hp
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>attack <span style="color:#f92672">=</span> attack
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>defence <span style="color:#f92672">=</span> defence
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getStatus</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;ステータス画面的なもの&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;HP: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> | Atk </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> | Def </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (self<span style="color:#f92672">.</span>hp, self<span style="color:#f92672">.</span>attack, self<span style="color:#f92672">.</span>defence)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dealDamage</span>(self, damage):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        ダメージを受ける
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        damage - 受けるダメージ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 実際のダメージは防御力のぶんだけ減算される</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ただし1を下限とする</span>
</span></span><span style="display:flex;"><span>        damage <span style="color:#f92672">=</span> max(damage <span style="color:#f92672">-</span> self<span style="color:#f92672">.</span>defence, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># HPからダメージを減らす</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>hp <span style="color:#f92672">-=</span> damage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">isDead</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;自分はもう死んでいる、かどうか&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>hp <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">attackTo</span>(self, enemy):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        別のUnitインスタンスに攻撃を仕掛ける
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        勝ったら正の値,負けたら負の値,引き分けなら0を返す
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        enemy - 攻撃を仕掛けるUnitインスタンス
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 自分が死んでいるなら即負け,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 相手が死んでいるなら即勝ち</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> enemy<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 攻撃側優先、攻撃力の分だけ相手にダメージを与える</span>
</span></span><span style="display:flex;"><span>        enemy<span style="color:#f92672">.</span>dealDamage(self<span style="color:#f92672">.</span>attack)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># この時点で相手が死んでいるなら勝ち</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> enemy<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 相手が死んでいないなら反撃を受ける</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 相手の攻撃力ぶんだけ自分にダメージを与える</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>dealDamage(enemy<span style="color:#f92672">.</span>attack)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># この時点で自分が死んでしまったら負け</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 自分も相手も死ななかったら引き分け判定</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ここからメインの処理</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> Unit(<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> Unit(<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>    print a<span style="color:#f92672">.</span>attackTo(b)
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;a | </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> a<span style="color:#f92672">.</span>getStatus()
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;b | </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> b<span style="color:#f92672">.</span>getStatus()
</span></span><span style="display:flex;"><span>    print
</span></span><span style="display:flex;"><span>        
</span></span></code></pre></div><h2 id="説明文">説明文</h2>
<p>各メソッドを見ていきましょう&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Unit</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;RPGのキャラっぽいなにか&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span></span></code></pre></div><p>&hellip;の前に、見慣れない表記が出てきています。<br>
クラスや関数の冒頭にある、<code>&quot;&quot;&quot;ダブルクオーテーション3つで囲まれた文字列&quot;&quot;&quot;</code>は、<br>
そのクラスやその関数の説明だとみなされます。<br>
そのクラスやその関数が何をするものなのか、わかりやすい名前をつけるのが一番ですが、<br>
やはり日本語で説明するほうがなにかとよいです。</p>
<p>特に関数では、引数や戻り値があります。<br>
それぞれの引数が何を表すのか(呼び出す際にどういう値を指定してほしいのか)、<br>
どういう戻り値を返しうるのか、などは<br>
名前だけでは十分に表しきれませんので、<em><strong>日本語で説明を加えるべきです。</strong></em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">attackTo</span>(self, enemy):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        別のUnitインスタンスに攻撃を仕掛ける
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        勝ったら正の値,負けたら負の値,引き分けなら0を返す
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        enemy - 攻撃を仕掛けるUnitインスタンス
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span></span></code></pre></div><h2 id="メソッド巡り">メソッド巡り</h2>
<p>こんどこそ各メソッドを見ていきましょう。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, hp, attack, defence):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;初期化時にHP,攻撃力,防御力を設定する&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>hp <span style="color:#f92672">=</span> hp
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>attack <span style="color:#f92672">=</span> attack
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>defence <span style="color:#f92672">=</span> defence
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span></span></code></pre></div><p>コンストラクタです。説明文の通りですね。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getStatus</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;ステータス画面的なもの&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;HP: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> | Atk </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> | Def </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (self<span style="color:#f92672">.</span>hp, self<span style="color:#f92672">.</span>attack, self<span style="color:#f92672">.</span>defence)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span></span></code></pre></div><p>現在のステータスを画面に出力する方法が欲しかったので、<br>
(何もしなければ変数の中身の値は見えません！)<br>
フォーマット文字列を使ってステータス画面っぽい文字列を生成して返しています。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dealDamage</span>(self, damage):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        ダメージを受ける
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        damage - 受けるダメージ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 実際のダメージは防御力のぶんだけ減算される</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ただし1を下限とする</span>
</span></span><span style="display:flex;"><span>        damage <span style="color:#f92672">=</span> max(damage <span style="color:#f92672">-</span> self<span style="color:#f92672">.</span>defence, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># HPからダメージを減らす</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>hp <span style="color:#f92672">-=</span> damage
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span></span></code></pre></div><p>ダメージを受けます。</p>
<p><code>max()</code>関数は、与えられた引数の中で最も大きい数を返す関数です。<br>
このことは、下限を設定することに応用できます。<br>
たとえば、片方の引数を<code>3</code>に、もう片方の引数をいろいろ変えて最も大きい数を暗算してみましょう。</p>
<ul>
<li><code>max(6,3)</code> -&gt; <code>6</code></li>
<li><code>max(5,3)</code> -&gt; <code>5</code></li>
<li><code>max(4,3)</code> -&gt; <code>4</code></li>
<li><code>max(3,3)</code> -&gt; <code>3</code></li>
<li><code>max(2,3)</code> -&gt; <code>3</code></li>
<li><code>max(1,3)</code> -&gt; <code>3</code></li>
</ul>
<p>変化する部分が<code>3</code>より大きいうちはそのままになり、<br>
しかも<code>3</code>よりは下がらないことがわかります。</p>
<p>ここでは、<code>damage = max(damage - self.defence, 1)</code>としています。<br>
自分の防御力のぶんだけダメージから引き(コンストラクタでインスタンス変数として設定していました)、<br>
ただし下限を<code>1</code>として、<code>damage</code>に再代入しています(変数の今の値を加工して、同じ変数に再び代入することができるのでしたね)。</p>
<p>ところで、&ldquo;変数から数字を引いて同じ変数に再代入する&quot;操作はよく使います。<br>
なので、専用の書き方があります。次の行の<code>self.hp -= damage</code>がそれです。<br>
&ldquo;<code>self.hp</code>から<code>damage</code>を引いて<code>self.hp</code>に再代入する&rdquo;、<br>
すなわち&rdquo;<code>self.hp</code>の値を<code>damage</code>だけ減らす&quot;ためにこの書き方を使うことができます。</p>
<p>この書き方は減算だけでなく加減乗除それぞれに用意されています。</p>
<ul>
<li><code>a += 3</code> : <code>a</code>に<code>3</code>を足す</li>
<li><code>a -= 3</code> : <code>a</code>から<code>3</code>を引く</li>
<li><code>a *= 3</code> : <code>a</code>に<code>3</code>を掛ける</li>
<li><code>a /= 3</code> : <code>a</code>から<code>3</code>を割る</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">isDead</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;自分はもう死んでいる、かどうか&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>hp <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span></span></code></pre></div><p>自分が死んでいるかどうかを判定します。<br>
(短いメソッドですが、あとでこれが活躍します)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">attackTo</span>(self, enemy):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        別のUnitインスタンスに攻撃を仕掛ける
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        勝ったら正の値,負けたら負の値,引き分けなら0を返す
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        enemy - 攻撃を仕掛けるUnitインスタンス
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 自分が死んでいるなら即負け,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 相手が死んでいるなら即勝ち</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> enemy<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 攻撃側優先、攻撃力の分だけ相手にダメージを与える</span>
</span></span><span style="display:flex;"><span>        enemy<span style="color:#f92672">.</span>dealDamage(self<span style="color:#f92672">.</span>attack)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># この時点で相手が死んでいるなら勝ち</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> enemy<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 相手が死んでいないなら反撃を受ける</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 相手の攻撃力ぶんだけ自分にダメージを与える</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>dealDamage(enemy<span style="color:#f92672">.</span>attack)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># この時点で自分が死んでしまったら負け</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 自分も相手も死ななかったら引き分け判定</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><p>他の<code>Unit</code>に攻撃を仕掛けます。<br>
<code>Unit</code>のインスタンスに属するメソッドでありながら、<br>
&ldquo;他の<code>Unit</code>インスタンス&quot;を引数に取っていることがポイントです。<br>
そうすることで操作できる<code>Unit</code>インスタンスが 自分:<code>self</code>と相手:<code>enemy</code> で<br>
2つになり、戦闘を実現できるようになります。</p>
<p><code>enemy</code>の<code>isDead()</code>や<code>enemy</code>の<code>dealDamage()</code>を呼び出して<br>
処理をしているところもポイントです。<br>
「<code>enemy</code>にあなたは死んでいますか、と聞く」・「<code>enemy</code>にお願いしてダメージを受けてもらう」<br>
というイメージでしょうか。<br>
<code>enemy</code>の内部状態のことは<code>enemy</code>自身が一番知っているはずですから、<br>
<code>enemy</code>の状態に関することは<code>enemy</code>にお願いする、<br>
またそうできるように最初から<code>Unit</code>のインスタンスメソッドを作っておく、ことが大事です。</p>
<p>さらにメインプログラムが続いています&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> Unit(<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> Unit(<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>    print a<span style="color:#f92672">.</span>attackTo(b)
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;a | </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> a<span style="color:#f92672">.</span>getStatus()
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;b | </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> b<span style="color:#f92672">.</span>getStatus()
</span></span><span style="display:flex;"><span>    print
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span></span></code></pre></div><p><code>Unit</code>のインスタンスを2つ作り、<br>
「<code>a</code>から<code>b</code>に攻撃してステータス画面を表示する」のを5回繰り返しています。</p>
<p>各自実行してみましょう。<br>
4回目の攻撃で<code>a</code>が<code>b</code>を削り切って勝っていることが確認できると思います。</p>
<h1 id="魔法を使いたい">魔法を使いたい</h1>
<p>殴り合うのもよいですが、やはり魔法での攻撃もしてみたいところです。<br>
「魔法攻撃は攻撃力ではなく魔法攻撃力を用いて計算し、<br>
反撃を受けないが、魔法が使えるのは魔法使いだけ」<br>
というのを目指しましょう。</p>
<p>従来の<code>Unit</code>の機能に加えて、魔法攻撃ができる新しいクラスをつくります。<br>
「継承」の出番です。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Wizard</span>(Unit):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;魔法使い&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">magicalAttackTo</span>(self, enemy):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        別のUnitインスタンスに魔法攻撃を仕掛ける
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        勝ったら正の値,負けたら負の値,引き分けなら0を返す
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        enemy - 攻撃を仕掛けるUnitインスタンス
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 自分が死んでいるなら即負け,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 相手が死んでいるなら即勝ち</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> enemy<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 魔法攻撃力の分だけ相手にダメージを与える</span>
</span></span><span style="display:flex;"><span>        enemy<span style="color:#f92672">.</span>dealDamage(self<span style="color:#f92672">.</span>magic_attack)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># この時点で相手が死んでいるなら勝ち</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> enemy<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 魔法なので反撃なし、死ななかったら引き分け判定</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span></span></code></pre></div><p>&hellip;これが<code>Wizard</code>クラスの定義のすべてです。<br>
<code>Unit</code>クラスを継承して<code>Wizard</code>クラスをつくり、魔法攻撃用のメソッドを1つ追加しています。<br>
<code>Unit</code>クラスを継承しているので、<code>Unit</code>クラスに定義されていたもの――<code>self.hp</code>,<code>self.attack</code>,<code>self.defence</code>,<code>self.isDead()</code>,<code>self.dealDamage()</code>,などなど――がすべて<code>Wizard</code>クラスに引き継がれています。<br>
追加分だけを書けばよい、ということになります。</p>
<p><code>Unit</code>クラスはそこにそのまま存在していることにも注意してください。<br>
引き続き<code>Unit</code>のインスタンスは作成することができ、戦闘をさせることもできつつ、<br>
<code>Wizard</code>のインスタンスも新しく作成できるのです。</p>
<p>さらに、<code>Wizard</code>は<code>Unit</code>から<em><strong>すべてを</strong></em>引き継いでいるので、<br>
<code>Unit</code>で出来たことは<code>Wizard</code>でもできます。<br>
<code>Wizard</code>のインスタンス<code>a</code>と<code>b</code>に拳で殴り合わせる(<code>a.attackTo(b)</code>)ことも可能です。<br>
<code>attackTo()</code>を処理するためには<code>self</code>と<code>enemy</code>の双方に<br>
変数<code>attack</code>,メソッド<code>isDead()</code>,メソッド<code>dealDamage()</code><br>
がなければなりませんが、<code>Wizard</code>インスタンスにもそれらは存在していますから、<br>
(なぜなら<em><strong>すべてを</strong></em>引き継いでいるから、記述していないのに！)<br>
問題なく<code>attackTo()</code>を呼び出すことができます。</p>
<p>さらにいえば、<code>Wizard</code>から<code>Unit</code>に<code>attackTo()</code>することも、<br>
まったく同じ理屈で可能です。<br>
<code>Wizard</code>から<code>Unit</code>へは魔法攻撃、<code>Unit</code>から<code>Wizard</code>へは通常攻撃、を<br>
1セットにして繰り返すメインプログラムにしてみましょう。<br>
こうなります&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> Unit(<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> Wizard(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>b<span style="color:#f92672">.</span>magic_attack <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>    print b<span style="color:#f92672">.</span>magicalAttackTo(a)
</span></span><span style="display:flex;"><span>    print a<span style="color:#f92672">.</span>attackTo(b)
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;a | </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> a<span style="color:#f92672">.</span>getStatus()
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;b | </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> b<span style="color:#f92672">.</span>getStatus()
</span></span><span style="display:flex;"><span>    print
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span></span></code></pre></div><p>プログラム全体は次のようになります。<br>
各自実行してみましょう&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># -*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Unit</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;RPGのキャラっぽいなにか&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, hp, attack, defence):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;初期化時にHP,攻撃力,防御力を設定する&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>hp <span style="color:#f92672">=</span> hp
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>attack <span style="color:#f92672">=</span> attack
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>defence <span style="color:#f92672">=</span> defence
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">getStatus</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;ステータス画面的なもの&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;HP: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> | Atk </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> | Def </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (self<span style="color:#f92672">.</span>hp, self<span style="color:#f92672">.</span>attack, self<span style="color:#f92672">.</span>defence)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dealDamage</span>(self, damage):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        ダメージを受ける
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        damage - 受けるダメージ
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 実際のダメージは防御力のぶんだけ減算される</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ただし1を下限とする</span>
</span></span><span style="display:flex;"><span>        damage <span style="color:#f92672">=</span> max(damage <span style="color:#f92672">-</span> self<span style="color:#f92672">.</span>defence, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># HPからダメージを減らす</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>hp <span style="color:#f92672">-=</span> damage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">isDead</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;自分はもう死んでいる、かどうか&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>hp <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">attackTo</span>(self, enemy):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        別のUnitインスタンスに攻撃を仕掛ける
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        勝ったら正の値,負けたら負の値,引き分けなら0を返す
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        enemy - 攻撃を仕掛けるUnitインスタンス
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 自分が死んでいるなら即負け,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 相手が死んでいるなら即勝ち</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> enemy<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 攻撃側優先、攻撃力の分だけ相手にダメージを与える</span>
</span></span><span style="display:flex;"><span>        enemy<span style="color:#f92672">.</span>dealDamage(self<span style="color:#f92672">.</span>attack)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># この時点で相手が死んでいるなら勝ち</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> enemy<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 相手が死んでいないなら反撃を受ける</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 相手の攻撃力ぶんだけ自分にダメージを与える</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>dealDamage(enemy<span style="color:#f92672">.</span>attack)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># この時点で自分が死んでしまったら負け</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 自分も相手も死ななかったら引き分け判定</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Wizard</span>(Unit):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;魔法使い&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">magicalAttackTo</span>(self, enemy):
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        別のUnitインスタンスに魔法攻撃を仕掛ける
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        勝ったら正の値,負けたら負の値,引き分けなら0を返す
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        enemy - 攻撃を仕掛けるUnitインスタンス
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 自分が死んでいるなら即負け,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 相手が死んでいるなら即勝ち</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> enemy<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 魔法攻撃力の分だけ相手にダメージを与える</span>
</span></span><span style="display:flex;"><span>        enemy<span style="color:#f92672">.</span>dealDamage(self<span style="color:#f92672">.</span>magic_attack)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># この時点で相手が死んでいるなら勝ち</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> enemy<span style="color:#f92672">.</span>isDead():
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># 魔法なので反撃なし、死ななかったら引き分け判定</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> Unit(<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> Wizard(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>b<span style="color:#f92672">.</span>magic_attack <span style="color:#f92672">=</span> <span style="color:#ae81ff">13</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>    print b<span style="color:#f92672">.</span>magicalAttackTo(a)
</span></span><span style="display:flex;"><span>    print a<span style="color:#f92672">.</span>attackTo(b)
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;a | </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> a<span style="color:#f92672">.</span>getStatus()
</span></span><span style="display:flex;"><span>    print <span style="color:#e6db74">&#34;b | </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> b<span style="color:#f92672">.</span>getStatus()
</span></span><span style="display:flex;"><span>    print
</span></span><span style="display:flex;"><span>    
</span></span></code></pre></div><p>&hellip;2ターン目で戦闘終了していることが確認できると思います。</p>

        </div>
        <div class="col-12">
  
</div>

      </div>

    </div>
  </div>

<footer id="contentinfo" class="footer">
  <address id="about" class="vcard body ml-2">
     <a href="https://gforestshade.github.io/kujira/">Kujira, Civ4 Mod Blog</a>  &copy; 2022 gforest_shade; licenced by <a href="https://creativecommons.org/licenses/by/4.0/deed.ja">CC-BY-4.0</a>
  </address>
</footer>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

</body>
</html>

